<!DOCTYPE html>
<html lang="en-US">
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WYJN75BMB1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-WYJN75BMB1');
    </script>

    <!-- Site Title -->
    <title>Geoffrey ðŸš€ Image Classification with MobileNet</title>
    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon-->
    <link rel="shortcut icon" href="../images/favicon.ico">
    <!-- Author Meta -->
    <meta name="author" content="Pratik Geoffrey Saxena">
    <!-- Meta Description -->
    <meta name="description" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <!-- Meta Keyword -->
    <meta name="keywords" content="portfolio">
    <!-- meta character set -->
    <meta charset="UTF-8">
    <!-- meta related tags -->
    <meta name="generator" content="">
    <meta name="keywords" content="Machine Learning, Visusalization, Tableau, Data Visualization, Blogs, Portfolio">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="robots" content="all">
    <meta content="Pratik Geoffrey Saxena" property="og:site_name">
    <meta content="website" property="og:type">
    <meta content="https://www.geoffreysaxena.tech/" property="og:url">
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="index.html" />
    <meta property="og:site_name" content="Absent Minded" />
    <meta content="Pratik Geoffrey Saxena Home Page" property="og:image:alt">
    <meta content="https://www.linkedin.com/in/geoffreysaxena/" property="og:see_also">
    <meta content="https://github.com/GeoffreySaxena/" property="og:see_also">
    <meta content="https://twitter.com/geoffrey_saxena" property="og:see_also">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@geoffrey_saxena">
    <meta name="twitter:creator" content="@geoffrey_saxena">
    <meta name="twitter:title" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <meta name="twitter:description" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <meta name="twitter:image:alt" content="Pratik Geoffrey Saxena Home Page">

    <meta property="og:title" content="Image Classification with MobileNet" />
    <meta property="og:description" content="Image Classification with MobileNet" />

    <!-- CSS/JS -->
    <link media="all" href="../assets/css/optimize_blogs.css" rel="stylesheet" />
    <link media="all" href="../assets/css/optimize_blogs_master.css" rel="stylesheet" />
    <link media="screen" href="../assets/css/main.css" rel="stylesheet" />
    <script defer src="../assets/js/optimize_main.js"></script>
    <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
</head>

<body class="post-template-default single single-post postid-261 single-format-standard wp-embed-responsive" data-scheme='dark' site-data-scheme='dark'>
    <div id="page" class="cs-site">
        <div class="cs-site-inner">
            <main id="main" class="cs-site-primary">
                <div class="cs-site-content">
                    <div id="content" class="cs-main-content">
                        <div class="cs-page-header-area" data-scheme="inverse" data-force="true">
                            <div class="cs-page-header-overlay cs-video-wrap">
                                <div class="cs-page-header-background cs-overlay-gradient-top cs-overlay-gradient-bottom">
                                    <div class="cs-page-header-background__inner cs-page-header-background__inner-current cs-active-prev-next"> <img width="960" height="960" src="../../wp-content/uploads/sites/28/demo-image-00007-80x80.jpg" class="attachment-csco-hero size-csco-hero pk-lqip pk-lazyload" alt="" loading="lazy" data-pk-sizes="auto" data-ls-sizes="(max-width: 960px) 100vw, 960px" data-pk-src="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-960x960.jpg" data-pk-srcset="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-960x960.jpg 960w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-150x150.jpg 150w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-80x80.jpg 80w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-160x160.jpg 160w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-1920x1920.jpg 1920w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-300x300.jpg 300w" /></div>
                                </div>

                                <div class="cs-page-header-item">
                                    <header id="masthead" class="cs-header cs-header-primary cs-header-social-links-enable">
                                        <div class="cs-header__inner cs-header__inner-desktop">
                                            <div class="cs-header__col cs-col-left">
                                                <div class="cs-logo "> <a class="cs-header__logo cs-logo-default " href="../index.html"> <img src="../../../../wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark.png" alt="Absent Minded" srcset="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark.png 1x, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark@2x.png 2x"> </a></div>
                                            </div>
                                            <div class="cs-header__col cs-col-right">
                                                <span class="cs-header__search-toggle" role="button"> <i class="cs-icon cs-icon-search"></i> <span class="cs-header__search-label">Search</span> </span> <span class="cs-header__menu-toggle" role="button">Menu</span>
                                            </div>
                                        </div>
                                    </header>
                                    <div class="cs-page-header-inner">
                                        <div class="cs-entry__header cs-entry__header-standard">
                                            <div class="cs-entry__header-inner">
                                                <div class="cs-entry__header-info">
                                                    <div class="cs-entry__header-info-inner">
                                                        <div class="cs-entry__header-description cs-entry__title-current cs-active-prev-next">
                                                            <div class="cs-entry__post-meta">
                                                                <div class="cs-meta-category">
                                                                    <ul class="post-categories">
                                                                        <li><a href="../category/category-javascript.html" rel="category tag">JavaScript</a></li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                            <h1 class="cs-entry__title"><span>Image Classification with MobileNet</span></h1>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="cs-menu cs-component" data-scheme="dark">
                                <div class="cs-menu__inner">
                                    <nav class="cs-menu__nav cs-menu__nav-main">
                                        <ul id="menu-primary" class="cs-menu__nav-inner cs-show-wrapper">
                                            <li id="menu-item-558" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-558"><a href="../index.html">Home</a></li>
                                            <li id="menu-item-577" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-577"><a href="#">Categories</a>
                                                <ul class="sub-menu">
                                                    <li id="menu-item-1839" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1839"><a href="../category/category-machine_learning.html">Machine Learning </a></li>
                                                    <li id="menu-item-578" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-578"><a href="../category/category-data_visualization.html">Data Visualization </a></li>
                                                    <li id="menu-item-1840" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1840"><a href="../category/category-javascript.html">JavaScript</a></li>
                                                    <li id="menu-item-1841" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1841"><a href="../category/category-makeover_monday.html">MakeoverMonday</a></li>
                                                    <li id="menu-item-1842" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1842"><a href="../category/category-coding_challenges.html">Coding Challenges</a></li>
                                                </ul>
                                            </li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="../about/geoffreysaxena.html">About</a></li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="https://www.geoffreysaxena.tech/portfolio/">Portfolio</a></li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="../contact/index.html">Contact</a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                        <div id="primary" class="cs-content-area">
                            <div class="cs-content-inner">
                                <header class="cs-header cs-header-secondary">
                                    <div class="cs-header__inner cs-header__inner-desktop">
                                        <div class="cs-header__col cs-col-left">
                                            <div class="cs-header__col-inner">
                                                <div class="cs-breadcrumbs" id="breadcrumbs"><span><span><a href="../index.html">Home</a> <span class="cs-separator"></span> <span><a href="../category/category-javascript.html">JavaScript</a></span></span></span></div>
                                                <div class="cs-entry__post-meta">
                                                    <div class="cs-meta-author"><a class="cs-meta-author-inner url fn n" href="../about/geoffreysaxena.html" title="Pratik Geoffrey Saxena"><span class="cs-author">Pratik Geoffrey Saxena</span></a></div>
                                                    <div class="cs-meta-date">February 19, 2021</div>
                                                    <div class="cs-meta-reading-time"><span class="cs-meta-icon"><i class="cs-icon cs-icon-clock"></i></span>7 minute read</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="cs-header__col cs-col-right">
                                            <div class="cs-header__col-inner"> <span role="button" class="cs-header__scheme-toggle cs-site-scheme-toggle"> <span class="cs-header__scheme-toggle-icons"> <i class="cs-header__scheme-toggle-icon cs-icon cs-icon-sun"></i> <i class="cs-header__scheme-toggle-icon cs-icon cs-icon-moon"></i> </span> <span class="cs-header__scheme-toggle-label-dark">Dark</span> <span class="cs-header__scheme-toggle-label-light">Light</span> </span></div>
                                        </div>
                                    </div>
                                </header>
                                <div class="cs-content-item">
                                    <div class="cs-entry__wrap">
                                        <div class="cs-entry__container">
                                            <div class="cs-entry__content-wrap">
                                                <div class="entry-content">
                                                    <p class="is-cnvs-dropcap-bordered">So, this is my starter code, we have two files, namely index.html &amp; sketch.js.</p>

                                                    <h5 class="pk-title pk-toc-title pk-font-block">index.html</h5>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.2.0/p5.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://unpkg.com/ml5@latest/dist/ml5.min.js">&lt;/script&gt;
    &lt;link rel="stylesheet" type="text/css" href="style.css">
    &lt;meta charset="utf-8" />

&lt;/head&gt;

&lt;body&gt;
    &lt;script src="sketch.js"&gt;&lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;</span></pre>
                                                    </figure>
                                                    </p>
                                                    <h5 class="pk-title pk-toc-title pk-font-block">sketch.js</h5>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">function setup() {
}</span></pre>
                                                    </figure>
                                                    </p>
                                                    <p>
                                                        I have imported the ml5 library &amp; the p5 library, Iâ€™m running the latest version as of writing this blog (p5.js â€“ 1.2.0).
                                                    </p>

                                                    <p>
                                                        Letâ€™s start by creating two variables, one for our model &amp; the other to store our image.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">let mobilenet;
let myimage;</span></pre>
                                                    </figure>
                                                    </p>


                                                    <p>
                                                        Now we move on to create the setup function. Here, we draw the canvas using the create canvas functions, set the background to black by using the background parameter.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">let canvas;
function setup() {
  canvas = createCanvas(400, 400);
  background(255);
}</span></pre>
                                                    </figure>
                                                    </p>

                                                    <p>
                                                        Once weâ€™re done with this, weâ€™ll initialize our mobile net model by calling the Image Classifier, and passing it two arguments i.e., the model name â€˜MobileNetâ€™ and the modelReady function.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">function setup() {
  canvas = createCanvas(400, 400);
  background(255);
  mobilenet = ml5.imageClassifier('MobileNet', modelReady)
}</span></pre>
                                                    </figure>
                                                    </p>

                                                    <p>
                                                        Then weâ€™ll proceed to create a function thatâ€™ll let us know once our model is ready, and once it does itâ€™ll just log it into the console log.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">function modelReady() {
  console.log('The model is loaded! ðŸš€');
}</span></pre>
                                                    </figure>
                                                    </p>

                                                    <p>
                                                        Finally, we can start classifying our images, letâ€™s create a function to create an image and pass it to our image. To render the image on our canvas we use the image hide function.
                                                    </p>

                                                    <p>
                                                        Now images donâ€™t render instantly in our browser, weâ€™ve got to wait for that to happen.
                                                    </p>

                                                    <p>
                                                        To do this, weâ€™ll just create a call back function and pass it to our create image function, and name it imageReady.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">function setup() {
  canvas = createCanvas(400, 400);
  myimage = createImg('images/my_img.jpg', imageReady);
  myimage.hide();
  background(255);
  mobilenet = ml5.imageClassifier('MobileNet', modelReady)
}</span></pre>
                                                    </figure>
                                                    </p>

                                                    <p>
                                                        Now weâ€™ll create our imageReady function, here we draw the image into our canvas by passing it the x, y, width, height values as parameters.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">function imageReady() {
  image(myimage, 0, 0, width, height);
}</span></pre>
                                                    </figure>
                                                    </p>

                                                    <p>
                                                        Running this piece of code renders or draws our image on our canvas.
                                                    </p>

                                                    <p>
                                                        Once weâ€™re finished with this we move on to create our predict function, again this doesnâ€™t happen instantaneously too so we need to provide it with a callback function that weâ€™ll name gotResults.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">function modelReady() {
  console.log('The model is loaded! ðŸš€');
  mobilenet.predict(myimage, gotResults);
}</span></pre>
                                                    </figure>
                                                    </p>

                                                    <p>
                                                        Letâ€™s create our callback function, which we named gotResults.
                                                        So, we create a function, and pass it two arguments, first the error &amp; then the results as ml5 follows an error first callback mechanism.
                                                    </p>

                                                    <p>
                                                        We just handle the error by logging in into the console &amp; move on.
                                                        To display the results on the HTML page rather than in the console log we can do the following, extract the label and the probability from the results array and create separate elements for it that weâ€™ll then display on the page.
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">function gotResults(error, results) {
  if (error) {
    console.error(error);
  } else {
    console.log(results);
    let label = results[0].className;
    let prob = results[0].probability;
    fill(0);
    textSize(64);
    text(label, 10, height - 100);
    createP(label);
    createP(prob);
  }
}</span></pre>
                                                    </figure>
                                                    </p>

                                                    <p>
                                                        Combine all the code snippets and your sketch.js file should look something like this:
                                                    </p>

                                                    <p>
                                                    <figure class="highlight">
                                                        <pre><span class="p">let mobilenet;
let puffin;

function modelReady() {
  console.log('The model is loaded! ðŸš€');
  mobilenet.predict(myimage, gotResults);
}

function gotResults(error, results) {
  if (error) {
    console.error(error);
  } else {
    console.log(results);
    let label = results[0].className;
    let prob = results[0].probability;
    fill(0);
    textSize(64);
    text(label, 10, height - 100);
    createP(label);
    createP(prob);
  }
}

function imageReady() {
  image(myimage, 0, 0, width, height);
}

function setup() {
  canvas = createCanvas(400, 400);
  myimage = createImg('images/my_img.jpg', imageReady);
  myimage.hide();
  background(255);
  mobilenet = ml5.imageClassifier('MobileNet', modelReady)
}
</span></pre>
                                                    </figure>
                                                    </p>

                                                </div>
                                                <div class="cs-entry__author">
                                                    <div class="cs-entry__author-inner"> <a href="../about/geoffreysaxena.html" class="cs-entry__author-photo"> <img alt='' src='../images/geffy.webp' class='avatar avatar-100 photo' height='100' width='100' loading='lazy' /> </a>
                                                        <div class="cs-entry__author-info"> <span class="cs-entry__author-position">Author</span>
                                                            <div class="cs-entry__author-name-wrapper">
                                                                <h4 class="cs-entry__author-name"> <a href="../about/geoffreysaxena.html"> Pratik Geoffrey Saxena </a></h4>

                                                                <div class="cs-entry__author-social">
                                                                    <div class="pk-author-social-links pk-social-links-wrap pk-social-links-template-default">

                                                                        <div class="pk-social-links-items">
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://github.com/geoffreysaxena" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:github" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://www.linkedin.com/in/geoffreysaxena/" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:linkedin-rect" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://public.tableau.com/profile/saxenageoffrey#!/" target="_blank" rel="noopener"><span class="iconify" data-icon="cib:tableau" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a style="--ionicon-stroke-width: 64px" class="social__link" href="https://twitter.com/geoffrey_saxena" target="_blank" rel="noopener"><span class="iconify" data-icon="el:twitter" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a style="--ionicon-stroke-width: 128px" class="social__link" href="https://www.geoffreysaxena.tech/" target="_blank" rel="noopener"><span class="iconify" data-icon="whh:website" data-inline="false"></span>
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="cs-entry__author-description">In here, you can read about my adventures with Machine Learning, Deep Learning, Data Visualization &amp; JavaScript! </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div> <a href="#top" class="pk-scroll-to-top"> <i class="pk-icon pk-icon-up"></i> </a>
    <div id="fb-root"></div>

    <script id='powerkit-typekit-js-extra'>
        var powerkit_typekit = {
            "kit": "eug4kdn"
        };
    </script>
    <script src='../assets/js/powerkit-typekit.js' id='powerkit-typekit-js'></script>
    <script id='csco-scripts-js-extra'>
        var csLocalize = {
            "siteSchemeMode": "dark",
            "siteSchemeToogle": "1"
        };
    </script>
</body>

</html>