<!DOCTYPE html>
<html lang="en-US">
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WYJN75BMB1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-WYJN75BMB1');
    </script>

    <!-- Site Title -->
    <title>Geoffrey ðŸš€ Dog Breed Classification Using CNN's</title>
    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon-->
    <link rel="shortcut icon" href="../images/favicon.ico">
    <!-- Author Meta -->
    <meta name="author" content="Pratik Geoffrey Saxena">
    <!-- Meta Description -->
    <meta name="description" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <!-- Meta Keyword -->
    <meta name="keywords" content="portfolio">
    <!-- meta character set -->
    <meta charset="UTF-8">
    <!-- meta related tags -->
    <meta name="generator" content="">
    <meta name="keywords" content="Machine Learning, Visusalization, Tableau, Data Visualization, Blogs, Portfolio">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="robots" content="all">
    <meta content="Pratik Geoffrey Saxena" property="og:site_name">
    <meta content="website" property="og:type">
    <meta content="https://www.geoffreysaxena.tech/" property="og:url">
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="index.html" />
    <meta property="og:site_name" content="Absent Minded" />
    <meta content="Pratik Geoffrey Saxena Home Page" property="og:image:alt">
    <meta content="https://www.linkedin.com/in/geoffreysaxena/" property="og:see_also">
    <meta content="https://github.com/GeoffreySaxena/" property="og:see_also">
    <meta content="https://twitter.com/geoffrey_saxena" property="og:see_also">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@geoffrey_saxena">
    <meta name="twitter:creator" content="@geoffrey_saxena">
    <meta name="twitter:title" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <meta name="twitter:description" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <meta name="twitter:image:alt" content="Pratik Geoffrey Saxena Home Page">

    <meta property="og:title" content="Dog Breed Classification Using CNN's" />
    <meta property="og:description" content="Dog Breed Classification Using CNN's" />

    <!-- CSS/JS -->
    <link media="all" href="../assets/css/optimize_blogs.css" rel="stylesheet" />
    <link media="all" href="../assets/css/optimize_blogs_master.css" rel="stylesheet" />
    <link media="screen" href="../assets/css/main.css" rel="stylesheet" />
    <script defer src="../assets/js/optimize_main.js"></script>
    <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
</head>

<body class="post-template-default single single-post postid-261 single-format-standard wp-embed-responsive" data-scheme='dark' site-data-scheme='dark'>
    <div id="page" class="cs-site">
        <div class="cs-site-inner">
            <main id="main" class="cs-site-primary">
                <div class="cs-site-content">
                    <div id="content" class="cs-main-content">
                        <div class="cs-page-header-area" data-scheme="inverse" data-force="true">
                            <div class="cs-page-header-overlay cs-video-wrap">
                                <div class="cs-page-header-background cs-overlay-gradient-top cs-overlay-gradient-bottom">
                                    <div class="cs-page-header-background__inner cs-page-header-background__inner-current cs-active-prev-next"> <img width="960" height="960" src="../../wp-content/uploads/sites/28/demo-image-00007-80x80.jpg" class="attachment-csco-hero size-csco-hero pk-lqip pk-lazyload" alt="" loading="lazy" data-pk-sizes="auto" data-ls-sizes="(max-width: 960px) 100vw, 960px" data-pk-src="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-960x960.jpg" data-pk-srcset="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-960x960.jpg 960w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-150x150.jpg 150w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-80x80.jpg 80w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-160x160.jpg 160w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-1920x1920.jpg 1920w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-300x300.jpg 300w" /></div>
                                </div>

                                <div class="cs-page-header-item">
                                    <header id="masthead" class="cs-header cs-header-primary cs-header-social-links-enable">
                                        <div class="cs-header__inner cs-header__inner-desktop">
                                            <div class="cs-header__col cs-col-left">
                                                <div class="cs-logo "> <a class="cs-header__logo cs-logo-default " href="../index.html"> <img src="../../../../wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark.png" alt="Absent Minded" srcset="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark.png 1x, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark@2x.png 2x"> </a></div>
                                            </div>
                                            <div class="cs-header__col cs-col-right">
                                                <span class="cs-header__search-toggle" role="button"> <i class="cs-icon cs-icon-search"></i> <span class="cs-header__search-label">Search</span> </span> <span class="cs-header__menu-toggle" role="button">Menu</span>
                                            </div>
                                        </div>
                                    </header>
                                    <div class="cs-page-header-inner">
                                        <div class="cs-entry__header cs-entry__header-standard">
                                            <div class="cs-entry__header-inner">
                                                <div class="cs-entry__header-info">
                                                    <div class="cs-entry__header-info-inner">
                                                        <div class="cs-entry__header-description cs-entry__title-current cs-active-prev-next">
                                                            <div class="cs-entry__post-meta">
                                                                <div class="cs-meta-category">
                                                                    <ul class="post-categories">
                                                                        <li><a href="../category/category-machine_learning.html" rel="category tag">Machine Learning</a></li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                            <h1 class="cs-entry__title"><span>Dog Breed Classification Using CNN's</span></h1>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="cs-menu cs-component" data-scheme="dark">
                                <div class="cs-menu__inner">
                                    <nav class="cs-menu__nav cs-menu__nav-main">
                                        <ul id="menu-primary" class="cs-menu__nav-inner cs-show-wrapper">
                                            <li id="menu-item-558" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-558"><a href="../index.html">Home</a></li>
                                            <li id="menu-item-577" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-577"><a href="#">Categories</a>
                                                <ul class="sub-menu">
                                                    <li id="menu-item-1839" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1839"><a href="../category/category-machine_learning.html">Machine Learning </a></li>
                                                    <li id="menu-item-578" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-578"><a href="../category/category-data_visualization.html">Data Visualization </a></li>
                                                    <li id="menu-item-1840" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1840"><a href="../category/category-javascript.html">JavaScript</a></li>
                                                    <li id="menu-item-1841" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1841"><a href="../category/category-makeover_monday.html">MakeoverMonday</a></li>
                                                    <li id="menu-item-1842" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1842"><a href="../category/category-coding_challenges.html">Coding Challenges</a></li>
                                                </ul>
                                            </li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="../about/geoffreysaxena.html">About</a></li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="https://www.geoffreysaxena.tech/portfolio/">Portfolio</a></li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="../contact/index.html">Contact</a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                        <div id="primary" class="cs-content-area">
                            <div class="cs-content-inner">
                                <header class="cs-header cs-header-secondary">
                                    <div class="cs-header__inner cs-header__inner-desktop">
                                        <div class="cs-header__col cs-col-left">
                                            <div class="cs-header__col-inner">
                                                <div class="cs-breadcrumbs" id="breadcrumbs"><span><span><a href="../index.html">Home</a> <span class="cs-separator"></span> <span><a href="../category/category-machine_learning.html">Machine Learning</a></span></span></span></div>
                                                <div class="cs-entry__post-meta">
                                                    <div class="cs-meta-author"><a class="cs-meta-author-inner url fn n" href="../about/geoffreysaxena.html" title="Pratik Geoffrey Saxena"><span class="cs-author">Pratik Geoffrey Saxena</span></a></div>
                                                    <div class="cs-meta-date">February 19, 2021</div>
                                                    <div class="cs-meta-reading-time"><span class="cs-meta-icon"><i class="cs-icon cs-icon-clock"></i></span>7 minute read</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="cs-header__col cs-col-right">
                                            <div class="cs-header__col-inner"> <span role="button" class="cs-header__scheme-toggle cs-site-scheme-toggle"> <span class="cs-header__scheme-toggle-icons"> <i class="cs-header__scheme-toggle-icon cs-icon cs-icon-sun"></i> <i class="cs-header__scheme-toggle-icon cs-icon cs-icon-moon"></i> </span> <span class="cs-header__scheme-toggle-label-dark">Dark</span> <span class="cs-header__scheme-toggle-label-light">Light</span> </span></div>
                                        </div>
                                    </div>
                                </header>
                                <div class="cs-content-item">
                                    <div class="cs-entry__wrap">
                                        <div class="cs-entry__container">
                                            <div class="cs-entry__content-wrap">
                                                <div class="entry-content">
                                                    <h4>I have to admit ä¸€ Dogs are absolutely beautiful &amp; who doesn't love them?</h4>



                                                    <p> Have you ever looked at a dog and didn't know it's breed? What if tell you, you can find it's exact breed if you'd taken a photo and passed it through my model! Artificial Intelligence has come a long way, from basic functionalities such as Linear Regression to advanced and complex applications such as health care.
                                                    </p>

                                                    <p>I was studying about Deep Neural Networks and I wanted to try a hands-on implementation of image classification.I found a wonderful dataset collected by Stanford, titled 'Stanford Dogs dataset for Fine-Grained Visual Categorization'
                                                    </p>

                                                    <p> I created a deep neural network leveraging transfer learning by using the Inception V3 neural net and built my very own dog breed classifier! I trained my model and achived an accuracy of 85%. In the process I utilized almost all the concepts I'd learned ranging from image augmentation, scaling, defining callbacks, etc.
                                                    </p>



                                                    <p>So let's start off by importing our libraries:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/9773a759cba6c9055bae05754bd5ca78.js"></script>

                                                    <p>Those were our basic libraries, let's import our scikit-learn library:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/1f5cfa9dd13d957bdb0fd9b941d565c7.js"></script>


                                                    <p>Now let's import the TensorFlow libraries:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/71a2136060252dee4e7585e1f834f557.js"></script>


                                                    <p>Let's go-ahead to import the dataset directory:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/75d913cb8b47606aec08979229377b7e.js"></script>


                                                    <p>This gives us a messy output:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/20823c81f1d3020601de122917490f82.js"></script>


                                                    <p>Let's just get the names of the dogs without the image number:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/b3cb5f6de133d580cabbeacb26638f8d.js"></script>


                                                    <p>This gives us a pretty neat output:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/1a33e50d61e9cf113282192da9024195.js"></script>


                                                    <p>Now we shall rewrite the file names of our images with their complete paths, as this makes it a lot easier to process:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/e1867248e95fec1c2c5e5e461feb03e8.js"></script>


                                                    <p>Now, we'll pair up our X's and y's by zipping them up:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/732c7964374aa0d237ee10eb5145bbfb.js"></script>


                                                    <p>Even though we have 20k images, I wasn't able to process all of them due to computational issues [This part frustrated me for hours, I didn't understand the issue I was facing. My kernel just kept crashing every time. I finally realized that subsetting or slicing my data would help] We can subset or slice our data by doing this:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/15f6533fefbd939a45d87b09055b2b99.js"></script>

                                                    <p>Now we'll One-Hot Encode our data:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/5954d79ced0e4e4bfa2b091256b7cf71.js"></script>


                                                    <p>Here we'll split our data into a training and testing set:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/adf2e801a2eeaf34fd624a1f487df60e.js"></script>


                                                    <p>Again due to computational issues, I figured it's best to free up some memory:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/3233074eef96b02b82ea91e96b39948d.js"></script>


                                                    <p>I was going to train a model from scratch, and then I had plans of trying out Transfer Learning, but given the fact that we have only 4000 images to work with I figured it's best to use only Transfer Learning.</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/c10cdd7f5ceabe53deeaa4c311e246ea.js"></script>

                                                    <p>Now we take the 9th layer of the InceptionV3 as our input:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/225ffe0b09f2bfb62f595a99d3a16530.js"></script>


                                                    <p>Let's define a callback function, that stops iterating once we've reached our desired accuracy level. [I realized later I didn't need this as my model wasn't going to be 97% accurate]</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/7bad3fe0060ade11f734e62f17971651.js"></script>


                                                    <p>Here we form the heart [if you'd like to call it] of our model

                                                        ~ the Convolutional Neural Network</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/dadd469e26ff2b1be595c547b0d09340.js"></script>

                                                    <p>We get a pretty neat output:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/d25a5fd9a98452006d08aae74434a7c4.js"></script>


                                                    <p>To plot the structure of our model and get it as a Portable Network Graphics file:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/fbff21ae91b7697625d3b844a171148d.js"></script>


                                                    <p>We move on to create a generator for training and validating:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/152fa3f9f5118aafe009c351ce80f101.js"></script>


                                                    <p>We've finally arrived at the fun part [time-consuming one too!], where we train the NN</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/645eeb30374202d125d76064bf66db04.js"></script>


                                                    <p>This takes over 30 mins given each epoch takes around 40 secs or so:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/0639b2ed4a23bfeb7a25a817a9897f96.js"></script>


                                                    <p>We finish off by plotting a graph that shows us our accuracy and loss over epochs:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/74f0f7a3b9403cc10eba6ed2c4bc2e28.js"></script>


                                                    <p> You can find the complete code in my GitHub Repository.</p>
                                                </div>
                                                <div class="cs-entry__author">
                                                    <div class="cs-entry__author-inner"> <a href="../about/geoffreysaxena.html" class="cs-entry__author-photo"> <img alt='' src='../images/geffy.webp' class='avatar avatar-100 photo' height='100' width='100' loading='lazy' /> </a>
                                                        <div class="cs-entry__author-info"> <span class="cs-entry__author-position">Author</span>
                                                            <div class="cs-entry__author-name-wrapper">
                                                                <h4 class="cs-entry__author-name"> <a href="../about/geoffreysaxena.html"> Pratik Geoffrey Saxena </a></h4>

                                                                <div class="cs-entry__author-social">
                                                                    <div class="pk-author-social-links pk-social-links-wrap pk-social-links-template-default">

                                                                        <div class="pk-social-links-items">
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://github.com/geoffreysaxena" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:github" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://www.linkedin.com/in/geoffreysaxena/" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:linkedin-rect" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://public.tableau.com/profile/saxenageoffrey#!/" target="_blank" rel="noopener"><span class="iconify" data-icon="cib:tableau" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a style="--ionicon-stroke-width: 64px" class="social__link" href="https://twitter.com/geoffrey_saxena" target="_blank" rel="noopener"><span class="iconify" data-icon="el:twitter" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a style="--ionicon-stroke-width: 128px" class="social__link" href="https://www.geoffreysaxena.tech/" target="_blank" rel="noopener"><span class="iconify" data-icon="whh:website" data-inline="false"></span>
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="cs-entry__author-description">In here, you can read about my adventures with Machine Learning, Deep Learning, Data Visualization &amp; JavaScript! </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div> <a href="#top" class="pk-scroll-to-top"> <i class="pk-icon pk-icon-up"></i> </a>
    <div id="fb-root"></div>

    <script id='powerkit-typekit-js-extra'>
        var powerkit_typekit = {
            "kit": "eug4kdn"
        };
    </script>
    <script src='../assets/js/powerkit-typekit.js' id='powerkit-typekit-js'></script>
    <script id='csco-scripts-js-extra'>
        var csLocalize = {
            "siteSchemeMode": "dark",
            "siteSchemeToogle": "1"
        };
    </script>
</body>

</html>