<!DOCTYPE html>
<html lang="en-US">
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WYJN75BMB1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-WYJN75BMB1');
    </script>

    <!-- Site Title -->
    <title>Geoffrey ðŸš€ Compose A Poem using NLP &amp; BERT</title>
    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon-->
    <link rel="shortcut icon" href="../images/favicon.ico">
    <!-- Author Meta -->
    <meta name="author" content="Pratik Geoffrey Saxena">
    <!-- Meta Description -->
    <meta name="description" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <!-- Meta Keyword -->
    <meta name="keywords" content="portfolio">
    <!-- meta character set -->
    <meta charset="UTF-8">
    <!-- meta related tags -->
    <meta name="generator" content="">
    <meta name="keywords" content="Machine Learning, Visusalization, Tableau, Data Visualization, Blogs, Portfolio">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="robots" content="all">
    <meta content="Pratik Geoffrey Saxena" property="og:site_name">
    <meta content="website" property="og:type">
    <meta content="https://www.geoffreysaxena.tech/" property="og:url">
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="index.html" />
    <meta property="og:site_name" content="Absent Minded" />
    <meta content="Pratik Geoffrey Saxena Home Page" property="og:image:alt">
    <meta content="https://www.linkedin.com/in/geoffreysaxena/" property="og:see_also">
    <meta content="https://github.com/GeoffreySaxena/" property="og:see_also">
    <meta content="https://twitter.com/geoffrey_saxena" property="og:see_also">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@geoffrey_saxena">
    <meta name="twitter:creator" content="@geoffrey_saxena">
    <meta name="twitter:title" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <meta name="twitter:description" content="A personal website built and deployed by Pratik Geoffrey Saxena.">
    <meta name="twitter:image:alt" content="Pratik Geoffrey Saxena Home Page">

    <meta property="og:title" content="Compose A Poem using NLP and BERT" />
    <meta property="og:description" content="Compose A Poem using NLP and BERT" />

    <!-- CSS/JS -->
    <link media="all" href="../assets/css/optimize_blogs.css" rel="stylesheet" />
    <link media="all" href="../assets/css/optimize_blogs_master.css" rel="stylesheet" />
    <link media="screen" href="../assets/css/main.css" rel="stylesheet" />
    <script defer src="../assets/js/optimize_main.js"></script>
    <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
</head>

<body class="post-template-default single single-post postid-261 single-format-standard wp-embed-responsive" data-scheme='dark' site-data-scheme='dark'>
    <div id="page" class="cs-site">
        <div class="cs-site-inner">
            <main id="main" class="cs-site-primary">
                <div class="cs-site-content">
                    <div id="content" class="cs-main-content">
                        <div class="cs-page-header-area" data-scheme="inverse" data-force="true">
                            <div class="cs-page-header-overlay cs-video-wrap">
                                <div class="cs-page-header-background cs-overlay-gradient-top cs-overlay-gradient-bottom">
                                    <div class="cs-page-header-background__inner cs-page-header-background__inner-current cs-active-prev-next"> <img width="960" height="960" src="../../wp-content/uploads/sites/28/demo-image-00007-80x80.jpg" class="attachment-csco-hero size-csco-hero pk-lqip pk-lazyload" alt="" loading="lazy" data-pk-sizes="auto" data-ls-sizes="(max-width: 960px) 100vw, 960px" data-pk-src="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-960x960.jpg" data-pk-srcset="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-960x960.jpg 960w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-150x150.jpg 150w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-80x80.jpg 80w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-160x160.jpg 160w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-1920x1920.jpg 1920w, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/demo-image-00007-300x300.jpg 300w" /></div>
                                </div>

                                <div class="cs-page-header-item">
                                    <header id="masthead" class="cs-header cs-header-primary cs-header-social-links-enable">
                                        <div class="cs-header__inner cs-header__inner-desktop">
                                            <div class="cs-header__col cs-col-left">
                                                <div class="cs-logo "> <a class="cs-header__logo cs-logo-default " href="../index.html"> <img src="../../../../wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark.png" alt="Absent Minded" srcset="https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark.png 1x, https://uppercasetheme.com/absent-minded/wp-content/uploads/sites/28/2020/09/absent-minded-logo-dark@2x.png 2x"> </a></div>
                                            </div>
                                            <div class="cs-header__col cs-col-right">
                                                <span class="cs-header__search-toggle" role="button"> <i class="cs-icon cs-icon-search"></i> <span class="cs-header__search-label">Search</span> </span> <span class="cs-header__menu-toggle" role="button">Menu</span>
                                            </div>
                                        </div>
                                    </header>
                                    <div class="cs-page-header-inner">
                                        <div class="cs-entry__header cs-entry__header-standard">
                                            <div class="cs-entry__header-inner">
                                                <div class="cs-entry__header-info">
                                                    <div class="cs-entry__header-info-inner">
                                                        <div class="cs-entry__header-description cs-entry__title-current cs-active-prev-next">
                                                            <div class="cs-entry__post-meta">
                                                                <div class="cs-meta-category">
                                                                    <ul class="post-categories">
                                                                        <li><a href="../category/category-machine_learning.html" rel="category tag">Machine Learning</a></li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                            <h1 class="cs-entry__title"><span>Compose A Poem using NLP &amp; BERT</span></h1>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="cs-menu cs-component" data-scheme="dark">
                                <div class="cs-menu__inner">
                                    <nav class="cs-menu__nav cs-menu__nav-main">
                                        <ul id="menu-primary" class="cs-menu__nav-inner cs-show-wrapper">
                                            <li id="menu-item-558" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-558"><a href="../index.html">Home</a></li>
                                            <li id="menu-item-577" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-577"><a href="#">Categories</a>
                                                <ul class="sub-menu">
                                                    <li id="menu-item-1839" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1839"><a href="../category/category-machine_learning.html">Machine Learning </a></li>
                                                    <li id="menu-item-578" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-578"><a href="../category/category-data_visualization.html">Data Visualization </a></li>
                                                    <li id="menu-item-1840" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1840"><a href="../category/category-javascript.html">JavaScript</a></li>
                                                    <li id="menu-item-1841" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1841"><a href="../category/category-makeover_monday.html">MakeoverMonday</a></li>
                                                    <li id="menu-item-1842" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1842"><a href="../category/category-coding_challenges.html">Coding Challenges</a></li>
                                                </ul>
                                            </li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="../about/geoffreysaxena.html">About</a></li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="https://www.geoffreysaxena.tech/portfolio/">Portfolio</a></li>
                                            <li id="menu-item-342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-342"><a href="../contact/index.html">Contact</a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                        <div id="primary" class="cs-content-area">
                            <div class="cs-content-inner">
                                <header class="cs-header cs-header-secondary">
                                    <div class="cs-header__inner cs-header__inner-desktop">
                                        <div class="cs-header__col cs-col-left">
                                            <div class="cs-header__col-inner">
                                                <div class="cs-breadcrumbs" id="breadcrumbs"><span><span><a href="../index.html">Home</a> <span class="cs-separator"></span> <span><a href="../category/category-machine_learning.html">Machine Learning</a></span></span></span></div>
                                                <div class="cs-entry__post-meta">
                                                    <div class="cs-meta-author"><a class="cs-meta-author-inner url fn n" href="../about/geoffreysaxena.html" title="Pratik Geoffrey Saxena"><span class="cs-author">Pratik Geoffrey Saxena</span></a></div>
                                                    <div class="cs-meta-date">February 19, 2021</div>
                                                    <div class="cs-meta-reading-time"><span class="cs-meta-icon"><i class="cs-icon cs-icon-clock"></i></span>7 minute read</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="cs-header__col cs-col-right">
                                            <div class="cs-header__col-inner"> <span role="button" class="cs-header__scheme-toggle cs-site-scheme-toggle"> <span class="cs-header__scheme-toggle-icons"> <i class="cs-header__scheme-toggle-icon cs-icon cs-icon-sun"></i> <i class="cs-header__scheme-toggle-icon cs-icon cs-icon-moon"></i> </span> <span class="cs-header__scheme-toggle-label-dark">Dark</span> <span class="cs-header__scheme-toggle-label-light">Light</span> </span></div>
                                        </div>
                                    </div>
                                </header>
                                <div class="cs-content-item">
                                    <div class="cs-entry__wrap">
                                        <div class="cs-entry__container">
                                            <div class="cs-entry__content-wrap">
                                                <div class="entry-content">
                                                    <p> Natural language processing (NLP) is a subfield of linguistics, computer science, and artificial intelligence concerned with the interactions between computers and human language, in particular how to program computers to process and analyze large amounts of natural language data. The result is a computer capable of "understanding" the contents of documents, including the contextual nuances of the language within them. The technology can then accurately extract information and insights contained in the documents as well as categorize and organize the documents themselves.
                                                    </p>

                                                    <p>Computers have come a long way, and so has machine learning. With state-of-the-art models such as BERT (Bidirectional Encoder Representations from Transformers), natural language processing has become easy!
                                                    </p>

                                                    <p> I created a deep neural network to write poems, my model uses BERT as it's base. Though I may have not generated a 'Robert Frost' level poem, I learnt a lot in the process. I utilized almost all the concepts I'd learned ranging from image augmentation, scaling, defining callbacks, etc.
                                                    </p>

                                                    <p>So let's start off by importing our libraries:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/280feeb04d4bedd04d670463fdfc9d15.js"></script>

                                                    <p>Those were our basic libraries, let's import our TensorFlow library:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/8c8cb7ce83540f31923ba01822f3c5a2.js"></script>


                                                    <p>Now, I'm working on Google Colab, so let's mount my Google Drive:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/e767e07fb654023c23b281f1f5126764.js"></script>


                                                    <p>Mounting my Google Drive with the help of this snippet:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/7c43444b31c0215fbd3c4603ad732578.js"></script>


                                                    <p>Now, let's tokenize all the unique letters in our collection of poems:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/f9cdf46ae4e7984516a72bdfe12a11d4.js"></script>


                                                    <p>This gives us an output like this:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/1f48d8b3648a9976d813fbe705ee307d.js"></script>


                                                    <p>Our index comprises of 6244 words, but you see the total words are 6245.

                                                        This is because an index is kept aside for 'Out-of-Vocabulary' words or OOV words.

                                                        Let's move on to form our corpus:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/d364fe11d6713a7167a02110bfe28ea9.js"></script>


                                                    <p>Now, let's pad our sentences, padding is basically making sure all our sentences are of the same length.

                                                        We achieve this but cutting out parts of a sentence or adding null to our sentences.</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/5907868e11c199ce2742b641466f7f78.js"></script>


                                                    <p>Now, let's split our data:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/2c18ce94f0595fc823fdd329d2cd4cc9.js"></script>


                                                    <p>Now if you wish to see the tokens allotted to certain words, we do this:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/b19bf80274a3ae7ac8f8f183e9915342.js"></script>

                                                    <p>And that results in this:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/505f5433d50fe78c04068880f3d7920a.js"></script>


                                                    <p>Here we form the heart [if you'd like to call it] of our model

                                                        ~ the Bidirectional Long Short Term Memory Neural Network</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/86a19a186b82627f6b93fc19f47fe137.js"></script>


                                                    <p>Let's print out the structure of our model:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/6e37ff04a2accd45fa1da3a487c6c66c.js"></script>


                                                    <p>That gives us a neat output:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/25efa6aed627faa13e1965cc7fbfb5de.js"></script>

                                                    <p>Let's define a callback function, that stops iterating once we've reached our desired accuracy level. [I realized later I didn't need this as my model wasn't going to be 95% accurate ~ sigh]</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/aefe09c90ad0cf9c4271aac15a215383.js"></script>


                                                    <p>We've finally arrived at the fun part [time-consuming one too!], where we train the NN

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/25590ca09fca98ca687875c0d4b0c52e.js"></script>


                                                    <p>This takes over 7.5 hours given each epoch takes around 60 secs or so:

                                                    </p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/563bcc830f8fab478a84cd906f18d283.js"></script>

                                                    <p>It was pretty impressive given the fact that it achieved an accuracy of 73% in the end.

                                                        Now, let's plot our Accuracy / Epoch graph:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/7f3be92ab99c9258198f56283c060211.js"></script>


                                                    <p>We get <a href="https://github.com/GeoffreySaxena/Creating-Poems-with-Deep-Learning/blob/master/1593204722882.png">this</a> beautiful graph, in which you can see how well our model has learned:

                                                    </p>

                                                    <p>Now, we finally arrive at the part where the magic happens:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/e6cacf4e0ab091c7d63c0699eb1875f5.js"></script>


                                                    <p>That gives us the following output:</p>

                                                    <script src="https://gist.github.com/GeoffreySaxena/d36aa4e6a432c3adf3e1ffe8278338d5.js"></script>


                                                    <p> Now, I agree that this isn't the best poem out there, although I do find it fascinating that a computer could generate this!

                                                        Also if you want the whole code feel free to check out my repository.
                                                    </p>

                                                </div>
                                                <div class="cs-entry__author">
                                                    <div class="cs-entry__author-inner"> <a href="../about/geoffreysaxena.html" class="cs-entry__author-photo"> <img alt='' src='../images/geffy.webp' class='avatar avatar-100 photo' height='100' width='100' loading='lazy' /> </a>
                                                        <div class="cs-entry__author-info"> <span class="cs-entry__author-position">Author</span>
                                                            <div class="cs-entry__author-name-wrapper">
                                                                <h4 class="cs-entry__author-name"> <a href="../about/geoffreysaxena.html"> Pratik Geoffrey Saxena </a></h4>

                                                                <div class="cs-entry__author-social">
                                                                    <div class="pk-author-social-links pk-social-links-wrap pk-social-links-template-default">

                                                                        <div class="pk-social-links-items">
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://github.com/geoffreysaxena" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:github" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://www.linkedin.com/in/geoffreysaxena/" target="_blank" rel="noopener" aria-label="social icon"><span class="iconify" data-icon="brandico:linkedin-rect" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a class="social__link" href="https://public.tableau.com/profile/saxenageoffrey#!/" target="_blank" rel="noopener"><span class="iconify" data-icon="cib:tableau" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a style="--ionicon-stroke-width: 64px" class="social__link" href="https://twitter.com/geoffrey_saxena" target="_blank" rel="noopener"><span class="iconify" data-icon="el:twitter" data-inline="false"></span>
                                                                            </a>
                                                                            <div class="pk-social-links-item pk-social-links-website"></div><a style="--ionicon-stroke-width: 128px" class="social__link" href="https://www.geoffreysaxena.tech/" target="_blank" rel="noopener"><span class="iconify" data-icon="whh:website" data-inline="false"></span>
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="cs-entry__author-description">In here, you can read about my adventures with Machine Learning, Deep Learning, Data Visualization &amp; JavaScript! </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div> <a href="#top" class="pk-scroll-to-top"> <i class="pk-icon pk-icon-up"></i> </a>
    <div id="fb-root"></div>

    <script id='powerkit-typekit-js-extra'>
        var powerkit_typekit = {
            "kit": "eug4kdn"
        };
    </script>
    <script src='../assets/js/powerkit-typekit.js' id='powerkit-typekit-js'></script>
    <script id='csco-scripts-js-extra'>
        var csLocalize = {
            "siteSchemeMode": "dark",
            "siteSchemeToogle": "1"
        };
    </script>
</body>

</html>